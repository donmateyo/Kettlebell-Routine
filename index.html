<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Armor Building Complex</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: "#FF6B35",
            secondary: "#FF8C42",
            accent: "#FFA500"
          },
          backdropBlur: { xs: "2px" }
        }
      }
    }
  </script>
</head>

<body
  class="bg-gradient-to-br from-gray-100 via-gray-200 to-gray-300 dark:from-gray-900 dark:via-gray-800 dark:to-gray-700 text-gray-900 dark:text-white min-h-screen">

  <!-- --------------- HEADER ---------------- -->
  <header class="container mx-auto px-4 py-6 max-w-4xl">
    <h1
      class="text-center text-4xl font-bold bg-gradient-to-r from-primary via-secondary to-accent bg-clip-text text-transparent drop-shadow-2xl">
      Armor Building Complex
    </h1>
    <p class="text-center text-gray-600 dark:text-gray-300 font-medium">8-Week Kettlebell Training Program</p>
  </header>

  <!-- --------------- MAIN ---------------- -->
  <main class="container mx-auto px-4 pb-10 max-w-4xl">

    <!-- WEEK SELECTOR -->
    <section
      class="backdrop-blur-md bg-white/20 dark:bg-gray-800/30 border border-white/30 dark:border-gray-700/50 rounded-xl p-6 mb-6 shadow-2xl">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-xl font-semibold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">
          Program Week
        </h2>

        <div class="flex items-center space-x-3">
          <button id="prevWeek" aria-label="Previous week"
            class="px-4 py-2 bg-gradient-to-r from-gray-200/80 to-gray-300/80 dark:from-gray-700/80 dark:to-gray-600/80 rounded-lg shadow-lg hover:from-gray-300/90 hover:to-gray-400/90 dark:hover:from-gray-600/90 dark:hover:to-gray-500/90">
            ‚Üê
          </button>
          <span id="currentWeek"
            class="text-3xl font-bold bg-gradient-to-r from-primary via-secondary to-accent bg-clip-text text-transparent min-w-[100px] text-center">Week
            1</span>
          <button id="nextWeek" aria-label="Next week"
            class="px-4 py-2 bg-gradient-to-r from-gray-200/80 to-gray-300/80 dark:from-gray-700/80 dark:to-gray-600/80 rounded-lg shadow-lg hover:from-gray-300/90 hover:to-gray-400/90 dark:hover:from-gray-600/90 dark:hover:to-gray-500/90">
            ‚Üí
          </button>
        </div>
      </div>

      <!-- injected by JS -->
      <div id="phaseInfo"></div>
    </section>

    <!-- DAY SELECTOR -->
    <section class="grid grid-cols-3 gap-4 mb-8">
      <button id="mondayBtn" class="day-btn" aria-label="Select Monday workout"></button>
      <button id="wednesdayBtn" class="day-btn" aria-label="Select Wednesday workout"></button>
      <button id="fridayBtn" class="day-btn" aria-label="Select Friday workout"></button>
    </section>

    <!-- WORKOUT CARD -->
    <section
      class="backdrop-blur-md bg-white/20 dark:bg-gray-800/30 border border-white/30 dark:border-gray-700/50 rounded-xl p-6 mb-8 shadow-2xl">
      <div class="flex items-center justify-between mb-6">
        <h3 id="workoutTitle"
          class="text-2xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">
          Armor Building Complex (ABC)
        </h3>
        <button id="markComplete" aria-label="Mark workout complete"
          class="px-6 py-2 bg-gradient-to-r from-green-500/80 to-green-600/80 hover:from-green-500 hover:to-green-600 text-white rounded-lg shadow-lg transition-all duration-200 font-semibold text-sm flex items-center space-x-2">
          <span aria-hidden="true">‚úì</span><span class="sr-only">Complete</span>
        </button>
      </div>

      <!-- PROGRESS HISTORY (hidden by default) -->
      <div id="progressHistory" class="hidden mb-6">
        <div
          class="backdrop-blur-sm bg-white/30 dark:bg-gray-700/30 border border-white/40 dark:border-gray-600/40 rounded-xl p-4 shadow-lg">
          <h4 class="font-bold text-sm flex items-center space-x-2 text-gray-800 dark:text-white mb-3">
            <span aria-hidden="true">üìà</span><span>Recent Progress</span>
          </h4>
          <div id="progressList" class="space-y-2 max-h-40 overflow-y-auto"></div>
        </div>
      </div>

      <!-- ABC WORKOUT -->
      <div id="abcWorkout" class="space-y-6">
        <div
          class="backdrop-blur-sm bg-white/40 dark:bg-gray-700/40 border border-white/50 dark:border-gray-600/50 rounded-xl p-5 shadow-xl">
          <h4 class="font-bold text-lg mb-4 text-gray-800 dark:text-white">ABC Structure (1 Round):</h4>
          <div class="grid md:grid-cols-2 gap-6">
            <div class="space-y-3">
              <div class="flex items-center space-x-3">
                <span
                  class="w-8 h-8 rounded-full bg-gradient-to-r from-primary to-secondary text-white flex items-center justify-center text-sm font-bold shadow-lg">1</span>
                <span>1 Clean + Press (L)</span>
              </div>
              <div class="flex items-center space-x-3">
                <span
                  class="w-8 h-8 rounded-full bg-gradient-to-r from-primary to-secondary text-white flex items-center justify-center text-sm font-bold shadow-lg">2</span>
                <span>1 Clean + Press (R)</span>
              </div>
              <div class="flex items-center space-x-3">
                <span
                  class="w-8 h-8 rounded-full bg-gradient-to-r from-primary to-secondary text-white flex items-center justify-center text-sm font-bold shadow-lg">3</span>
                <span>2 Front Squats (L)</span>
              </div>
              <div class="flex items-center space-x-3">
                <span
                  class="w-8 h-8 rounded-full bg-gradient-to-r from-accent to-primary text-white flex items-center justify-center text-sm font-bold shadow-lg"
                  aria-hidden="true">‚è±</span>
                <span class="text-accent">Rest 30 sec</span>
              </div>
            </div>
            <div class="space-y-3">
              <div class="flex items-center space-x-3">
                <span
                  class="w-8 h-8 rounded-full bg-gradient-to-r from-primary to-secondary text-white flex items-center justify-center text-sm font-bold shadow-lg">4</span>
                <span>1 Clean + Press (R)</span>
              </div>
              <div class="flex items-center space-x-3">
                <span
                  class="w-8 h-8 rounded-full bg-gradient-to-r from-primary to-secondary text-white flex items-center justify-center text-sm font-bold shadow-lg">5</span>
                <span>1 Clean + Press (L)</span>
              </div>
              <div class="flex items-center space-x-3">
                <span
                  class="w-8 h-8 rounded-full bg-gradient-to-r from-primary to-secondary text-white flex items-center justify-center text-sm font-bold shadow-lg">6</span>
                <span>2 Front Squats (R)</span>
              </div>
            </div>
          </div>
        </div>

        <!-- ROUND COUNTER -->
        <div
          class="backdrop-blur-sm bg-white/40 dark:bg-gray-700/40 border border-white/50 dark:border-gray-600/50 rounded-xl p-5 shadow-xl">
          <div class="flex items-center justify-between mb-4">
            <h4 class="font-bold text-lg text-gray-800 dark:text-white">Rounds Completed</h4>
            <div class="flex items-center space-x-4">
              <button id="minusRound" aria-label="Subtract round"
                class="w-12 h-12 rounded-full bg-gradient-to-r from-red-500 to-red-600 text-white text-lg font-bold shadow-lg hover:from-red-600 hover:to-red-700">‚àí</button>
              <span id="roundCount"
                class="text-4xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent min-w-[50px] text-center">0</span>
              <button id="plusRound" aria-label="Add round"
                class="w-12 h-12 rounded-full bg-gradient-to-r from-green-500 to-green-600 text-white text-lg font-bold shadow-lg hover:from-green-600 hover:to-green-700">+</button>
            </div>
          </div>
          <div id="targetRounds" class="text-center text-gray-600 dark:text-gray-300"></div>
        </div>
      </div>

      <!-- REST TIMER -->
      <div id="restTimer"
        class="hidden backdrop-blur-sm bg-white/40 dark:bg-gray-700/40 border border-white/50 dark:border-gray-600/50 rounded-xl p-5 mt-6 shadow-xl">
        <div class="text-center">
          <h4 class="font-bold text-lg mb-3 text-gray-800 dark:text-white">Rest Timer</h4>
          <div id="restDisplay"
            class="text-5xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent mb-6">00:30
          </div>
          <div class="space-x-4">
            <button id="startRest" aria-label="Start rest"
              class="px-8 py-3 rounded-xl bg-gradient-to-r from-primary to-secondary text-white shadow-lg hover:from-primary/90 hover:to-secondary/90">Start 30s Rest</button>
            <button id="resetRest" aria-label="Reset rest timer"
              class="px-8 py-3 rounded-xl bg-gradient-to-r from-gray-500 to-gray-600 text-white shadow-lg hover:from-gray-600 hover:to-gray-700">Reset</button>
          </div>
        </div>
      </div>

      <!-- PRESS WORKOUT -->
      <div id="pressWorkout" class="hidden mt-6">
        <div
          class="backdrop-blur-sm bg-white/40 dark:bg-gray-700/40 border border-white/50 dark:border-gray-600/50 rounded-xl p-5 shadow-xl">
          <h4 class="font-bold text-lg mb-4 text-gray-800 dark:text-white">Clean + Press Ladder</h4>
          <p class="text-center font-medium mb-2">Ladder sets: 2-3-5-10 (repeat as needed)</p>
          <p class="text-center text-gray-600 dark:text-gray-300 mb-6">Rest as needed between sets</p>

          <div class="flex items-center justify-between mb-6">
            <h5 class="font-bold text-gray-800 dark:text-white">Total Reps</h5>
            <div class="flex items-center space-x-4">
              <button id="minusRep" aria-label="Subtract rep"
                class="w-12 h-12 rounded-full bg-gradient-to-r from-red-500 to-red-600 text-white text-lg font-bold shadow-lg hover:from-red-600 hover:to-red-700">‚àí</button>
              <span id="repCount"
                class="text-4xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent min-w-[70px] text-center">0</span>
              <button id="plusRep" aria-label="Add rep"
                class="w-12 h-12 rounded-full bg-gradient-to-r from-green-500 to-green-600 text-white text-lg font-bold shadow-lg hover:from-green-600 hover:to-green-700">+</button>
            </div>
          </div>

          <div class="grid grid-cols-4 gap-3 mb-6">
            <button id="add2" class="rep-add px-4 py-3" aria-label="Add 2 reps">+2</button>
            <button id="add3" class="rep-add px-4 py-3" aria-label="Add 3 reps">+3</button>
            <button id="add5" class="rep-add px-4 py-3" aria-label="Add 5 reps">+5</button>
            <button id="add10" class="rep-add px-4 py-3" aria-label="Add 10 reps">+10</button>
          </div>
          <div id="targetReps" class="text-center text-gray-600 dark:text-gray-300"></div>
        </div>
      </div>
    </section>

    <!-- PEAK-WEEK TIMER -->
    <section id="workoutTimer"
      class="hidden backdrop-blur-md bg-gradient-to-br from-accent/20 to-primary/20 border border-accent/40 rounded-xl p-6 shadow-2xl">
      <div class="text-center">
        <h3
          class="text-2xl font-bold bg-gradient-to-r from-accent to-primary bg-clip-text text-transparent mb-3">Peak Week Timer
        </h3>
        <div id="workoutDisplay"
          class="text-6xl font-bold bg-gradient-to-r from-accent via-primary to-secondary bg-clip-text text-transparent mb-6">30:00
        </div>
        <div class="space-x-4">
          <button id="startWorkout" aria-label="Start 30-min timer"
            class="px-8 py-4 rounded-xl bg-gradient-to-r from-accent to-primary text-white shadow-xl hover:from-accent/90 hover:to-primary/90 font-bold">Start 30 Min Timer</button>
          <button id="resetWorkout" aria-label="Reset timer"
            class="px-8 py-4 rounded-xl bg-gradient-to-r from-gray-500 to-gray-600 text-white shadow-xl hover:from-gray-600 hover:to-gray-700 font-bold">Reset</button>
        </div>
        <div id="workoutGoal"
          class="mt-6 text-lg font-bold bg-gradient-to-r from-accent to-primary bg-clip-text text-transparent"></div>
      </div>
    </section>
  </main>

  <!-- --------------- SCRIPT ---------------- -->
  <script>
    /* ========== HELPER FUNCTIONS (hoisted) ========== */
    function query(sel) { return document.querySelector(sel) }
    function cap(s) { return s[0].toUpperCase() + s.slice(1) }
    function show(...sels) { sels.forEach(s => query(s).classList.remove("hidden")) }
    function hide(...sels) { sels.forEach(s => query(s).classList.add("hidden")) }
    function div(cls, text = "") { const d = document.createElement("div"); d.className = cls; d.textContent = text; return d }

    /* ========== MAIN APP ========== */
    (function () {
      /* ---- constants / state ---- */
      const DEFAULT_REST = 30, DEFAULT_WORKOUT = 1800;
      const dayMap = { mon: "monday", wed: "wednesday", fri: "friday" };
      let currentWeek = 1, currentDay = "monday";
      let roundCount = 0, repCount = 0;
      let restTimer = null, workoutTimer = null;
      let restSeconds = DEFAULT_REST, workoutSeconds = DEFAULT_WORKOUT;

      /* ---- storage ---- */
      const completedWorkouts = loadJSON("abcProgress", {});
      let workoutHistory = loadJSON("abcWorkoutHistory", []);

      function loadJSON(k, f) { try { const d = localStorage.getItem(k); return d ? JSON.parse(d) : f } catch { return f } }
      const saveJSON = (k, v) => { try { localStorage.setItem(k, JSON.stringify(v)) } catch { } };

      /* ---- dark mode ---- */
      const darkMQL = matchMedia("(prefers-color-scheme: dark)");
      setDark(darkMQL.matches);
      darkMQL.addEventListener("change", e => setDark(e.matches));
      function setDark(on) { document.documentElement.classList.toggle("dark", on) }

      /* ---- week data ---- */
      const weekData = {
        1: { phase: "Break-In", abcRounds: "5-10", pressReps: "20-40", description: "Break-In Phase: find correct bell size.", schedule: { monday: { name: "ABC + Press" }, wednesday: { name: "ABC + Press" }, friday: { name: "ABC + Press" } } },
        2: { phase: "Break-In", abcRounds: "5-10", pressReps: "20-40", description: "Break-In Phase: leave 2 reps in the tank.", schedule: { monday: { name: "ABC + Press" }, wednesday: { name: "ABC + Press" }, friday: { name: "ABC + Press" } } },
        3: { phase: "Volume Ramp-Up", abcRounds: "11-12", pressReps: "2-3-5-10", description: "Add 1-2 rounds weekly.", schedule: { monday: { name: "ABC Only" }, wednesday: { name: "Press Only" }, friday: { name: "ABC Only" } } },
        4: { phase: "Volume Ramp-Up", abcRounds: "13-14", pressReps: "2-3-5-10", description: "Add 1-2 rounds weekly.", schedule: { monday: { name: "ABC Only" }, wednesday: { name: "Press Only" }, friday: { name: "Press Only" } } },
        5: { phase: "Volume Ramp-Up", abcRounds: "15-16", pressReps: "2-3-5-10", description: "Add 1-2 rounds weekly.", schedule: { monday: { name: "ABC Only" }, wednesday: { name: "Press Only" }, friday: { name: "ABC Only" } } },
        6: { phase: "Volume Ramp-Up", abcRounds: "17-18", pressReps: "2-3-5-10", description: "Add 1-2 rounds weekly.", schedule: { monday: { name: "ABC Only" }, wednesday: { name: "Press Only" }, friday: { name: "Press Only" } } },
        7: { phase: "Peak Week", abcRounds: "30", pressReps: "2-3-5-10", description: "30 ABC rounds ‚â§30min or Press ladder.", schedule: { monday: { name: "ABC Only" }, wednesday: { name: "Press Only" }, friday: { name: "ABC Only" } } },
        8: { phase: "Peak Week", abcRounds: "30", pressReps: "100", description: "30 ABC rounds or 100 presses ‚â§30 min.", schedule: { monday: { name: "ABC Only" }, wednesday: { name: "Press Only" }, friday: { name: "Press Only" } } }
      };

      /* ---- classes ---- */
      const cls = {
        dayBtnBase: "day-btn px-6 py-4 rounded-xl bg-white/30 dark:bg-gray-700/30 border-2 border-white/40 dark:border-gray-600/40 hover:border-primary/60 hover:bg-gradient-to-br hover:from-primary/20 hover:to-secondary/10 text-gray-800 dark:text-white shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-105 relative",
        dayBtnActive: "day-btn px-6 py-4 rounded-xl bg-gradient-to-br from-primary/30 to-secondary/20 border-2 border-primary/50 text-gray-800 dark:text-white shadow-xl transition-all duration-300 hover:shadow-2xl hover:scale-105 relative",
        repAdd: "rep-add bg-gradient-to-r from-primary/80 to-secondary/80 text-white rounded-lg shadow-lg hover:from-primary hover:to-secondary transition-all duration-200 font-semibold"
      };
      document.querySelectorAll(".rep-add").forEach(b => b.className = `${cls.repAdd} ${b.className}`);

      /* ---- initial render ---- */
      updateWeekDisplay();
      updateDayButtons();
      updateWorkoutDisplay();
      updateCompletionDisplay();

      /* ---- listeners ---- */
      query("#prevWeek").addEventListener("click", () => { if (currentWeek > 1) { currentWeek--; weekChanged(); } });
      query("#nextWeek").addEventListener("click", () => { if (currentWeek < 8) { currentWeek++; weekChanged(); } });
      ["monday", "wednesday", "friday"].forEach(day => query(`#${day}Btn`).addEventListener("click", () => { currentDay = day; updateDaySelection(); updateWorkoutDisplay(); }));

      query("#plusRound").addEventListener("click", () => setRounds(roundCount + 1));
      query("#minusRound").addEventListener("click", () => setRounds(Math.max(0, roundCount - 1)));
      query("#plusRep").addEventListener("click", () => setReps(repCount + 1));
      query("#minusRep").addEventListener("click", () => setReps(Math.max(0, repCount - 1)));
      query("#add2").addEventListener("click", () => setReps(repCount + 2));
      query("#add3").addEventListener("click", () => setReps(repCount + 3));
      query("#add5").addEventListener("click", () => setReps(repCount + 5));
      query("#add10").addEventListener("click", () => setReps(repCount + 10));

      query("#startRest").addEventListener("click", startRestTimer);
      query("#resetRest").addEventListener("click", resetRestTimer);
      query("#startWorkout").addEventListener("click", startWorkoutTimer);
      query("#resetWorkout").addEventListener("click", resetWorkoutTimer);

      query("#markComplete").addEventListener("click", toggleComplete);

      document.body.addEventListener("click", e => {
        if (e.target.closest("[data-toggle-progress]")) {
          const ph = query("#progressHistory");
          ph.classList.toggle("hidden");
          if (!ph.classList.contains("hidden")) updateProgressHistory();
        }
      });

      window.addEventListener("beforeunload", () => { clearInterval(restTimer); clearInterval(workoutTimer); });

      /* ---- render helpers ---- */
      function weekChanged() {
        updateWeekDisplay(); updateDayButtons();
        currentDay = "monday"; updateDaySelection(); updateWorkoutDisplay(); updateCompletionDisplay();
      }

      function updateWeekDisplay() {
        query("#currentWeek").textContent = `Week ${currentWeek}`;
        const d = weekData[currentWeek];
        query("#phaseInfo").innerHTML = `
          <strong class="text-primary">${d.phase}:</strong>
          <span class="text-gray-700 dark:text-gray-200">${d.description}</span>
          <div class="mt-3 flex items-center justify-center space-x-3">
            <span class="text-xs text-gray-600 dark:text-gray-300">Week Progress:</span>
            <div class="flex items-center space-x-1">
              <div class="w-2 h-2 rounded-full" data-progress="mon"></div>
              <div class="w-2 h-2 rounded-full" data-progress="wed"></div>
              <div class="w-2 h-2 rounded-full" data-progress="fri"></div>
            </div>
            <span id="progressText" class="text-xs text-gray-600 dark:text-gray-300"></span>
            <button data-toggle-progress aria-label="Toggle history"
              class="px-2 py-1 text-white rounded-md bg-gradient-to-r from-blue-500/60 to-blue-600/60 text-xs shadow-sm">üìä</button>
          </div>`;
        updateWeekProgressIndicator();
      }

      function updateDayButtons() {
        const sch = weekData[currentWeek].schedule;
        ["monday", "wednesday", "friday"].forEach(dy => {
          const b = query(`#${dy}Btn`);
          b.className = cls.dayBtnBase;
          b.innerHTML = `${cap(dy)}<br><small>${sch[dy].name}</small>`;
        });
        updateDaySelection();
      }
      function updateDaySelection() {
        ["monday", "wednesday", "friday"].forEach(dy => query(`#${dy}Btn`).className = cls.dayBtnBase);
        query(`#${currentDay}Btn`).className = cls.dayBtnActive;
      }

      function updateWorkoutDisplay() {
        const d = weekData[currentWeek];
        const breakIn = currentWeek <= 2;
        const abcDay = currentDay === "monday" || (currentDay === "wednesday" && breakIn) || (currentDay === "friday" && (currentWeek <= 2 || currentWeek % 2 === 1));

        query("#targetRounds").textContent = `Target: ${d.abcRounds} rounds`;
        query("#targetReps").textContent = `Target: ${d.pressReps} reps`;

        if (breakIn) {
          query("#workoutTitle").textContent = "ABC + Press (Break-In)";
          show("#abcWorkout", "#restTimer", "#pressWorkout");
        } else if (abcDay) {
          query("#workoutTitle").textContent = "Armor Building Complex (ABC)";
          show("#abcWorkout", "#restTimer"); hide("#pressWorkout");
        } else {
          query("#workoutTitle").textContent = "Clean + Press Ladder";
          show("#pressWorkout"); hide("#abcWorkout", "#restTimer");
        }

        if (currentWeek >= 7) {
          show("#workoutTimer");
          query("#workoutGoal").textContent =
            currentWeek === 7 && abcDay ? "Goal : 30 ABC rounds ‚â§30 min"
              : currentWeek === 8 && !abcDay ? "Goal : 100 presses ‚â§30 min"
                : "Time cap : 30 min";
        } else hide("#workoutTimer");

        setRounds(0); setReps(0);
      }

      /* ---- counters ---- */
      function setRounds(n) { roundCount = n; query("#roundCount").textContent = n }
      function setReps(n) { repCount = n; query("#repCount").textContent = n }

      /* ---- timers ---- */
      function startRestTimer() {
        clearInterval(restTimer); restSeconds = DEFAULT_REST; toggleRestBtn(true);
        restTimer = setInterval(() => {
          restSeconds--; updateClock("#restDisplay", restSeconds);
          if (!restSeconds) { clearInterval(restTimer); query("#restDisplay").textContent = "REST COMPLETE!"; toggleRestBtn(false) }
        }, 1000);
      }
      function resetRestTimer() { clearInterval(restTimer); restSeconds = DEFAULT_REST; updateClock("#restDisplay", restSeconds); toggleRestBtn(false) }
      function toggleRestBtn(run) { const b = query("#startRest"); b.textContent = run ? "Running‚Ä¶" : "Start 30s Rest"; b.disabled = run }

      function startWorkoutTimer() {
        clearInterval(workoutTimer); workoutSeconds = DEFAULT_WORKOUT; toggleWorkoutBtn(true);
        workoutTimer = setInterval(() => {
          workoutSeconds--; updateClock("#workoutDisplay", workoutSeconds);
          if (!workoutSeconds) { clearInterval(workoutTimer); query("#workoutDisplay").textContent = "TIME UP!"; toggleWorkoutBtn(false) }
        }, 1000);
      }
      function resetWorkoutTimer() { clearInterval(workoutTimer); workoutSeconds = DEFAULT_WORKOUT; updateClock("#workoutDisplay", workoutSeconds); toggleWorkoutBtn(false) }
      function toggleWorkoutBtn(run) { const b = query("#startWorkout"); b.textContent = run ? "Running‚Ä¶" : "Start 30 Min Timer"; b.disabled = run }
      function updateClock(sel, s) { const m = String(Math.floor(s / 60)).padStart(2, "0"); query(sel).textContent = `${m}:${String(s % 60).padStart(2, "0")}` }

      /* ---- completion / history ---- */
      function toggleComplete() {
        const key = `${currentWeek}-${currentDay}`;
        const done = !completedWorkouts[key]; completedWorkouts[key] = done; saveJSON("abcProgress", completedWorkouts);
        if (done) saveWorkoutSession(); updateCompletionDisplay();
      }
      function saveWorkoutSession() {
        const breakIn = currentWeek <= 2;
        const abcDay = currentDay === "monday" || (currentDay === "wednesday" && breakIn) || (currentDay === "friday" && (currentWeek <= 2 || currentWeek % 2 === 1));
        workoutHistory.unshift({ date: new Date().toLocaleDateString(), week: currentWeek, day: currentDay, type: breakIn ? "ABC + Press" : abcDay ? "ABC" : "Press", rounds: abcDay ? roundCount : null, reps: (!abcDay || breakIn) ? repCount : null });
        workoutHistory = workoutHistory.slice(0, 10); saveJSON("abcWorkoutHistory", workoutHistory);
      }
      function updateCompletionDisplay() {
        const key = `${currentWeek}-${currentDay}`;
        query("#markComplete").className = completedWorkouts[key]
          ? "px-6 py-2 rounded-lg bg-gradient-to-r from-green-600 to-green-700 text-white shadow-lg font-semibold text-sm flex items-center space-x-2"
          : "px-6 py-2 rounded-lg bg-gradient-to-r from-green-500/80 to-green-600/80 hover:from-green-500 hover:to-green-600 text-white shadow-lg transition-all duration-200 font-semibold text-sm flex items-center space-x-2";
        updateDayButtonIndicators(); updateWeekProgressIndicator();
      }
      function updateDayButtonIndicators() {
        ["monday", "wednesday", "friday"].forEach(dy => {
          const btn = query(`#${dy}Btn`); btn.querySelector(".completion-dot")?.remove();
          if (completedWorkouts[`${currentWeek}-${dy}`]) {
            btn.append(div("completion-dot w-3 h-3 rounded-full bg-gradient-to-r from-green-500 to-green-600 border-2 border-white dark:border-gray-800 shadow-lg absolute -top-1 -right-1"));
          }
        });
      }
      function updateWeekProgressIndicator() {
        let done = 0;
        ["mon", "wed", "fri"].forEach(cd => {
          const el = query(`[data-progress=${cd}]`);
          const comp = completedWorkouts[`${currentWeek}-${dayMap[cd]}`];
          el.className = "w-2 h-2 rounded-full " + (comp ? "bg-gradient-to-r from-green-500 to-green-600 shadow-sm" : "bg-gray-300 dark:bg-gray-600");
          if (comp) done++;
        });
        query("#progressText").textContent = `${done}/3`;
      }

      /* ---- history list ---- */
      function updateProgressHistory() {
        const list = query("#progressList"); list.innerHTML = "";
        if (!workoutHistory.length) { list.append(div("text-center text-gray-500 dark:text-gray-400 text-sm py-4", "No workout history yet")); return }
        workoutHistory.forEach((s, i) => list.append(createRow(s, i)));
      }
      function createRow(s, i) {
        const row = div("flex items-center justify-between p-2 bg-white/20 dark:bg-gray-800/20 rounded-lg group");
        const left = div("flex-1");
        left.append(div("text-xs font-medium text-gray-800 dark:text-white", `Week ${s.week} ${cap(s.day)}`));
        left.append(div("text-xs text-gray-600 dark:text-gray-300", s.type)); row.append(left);

        const perf = s.rounds && s.reps ? `${s.rounds} rnds, ${s.reps} reps` : s.rounds ? `${s.rounds} rnds` : `${s.reps} reps`;
        const right = div("flex items-center space-x-2");
        const info = div("text-right"); info.append(div("text-xs font-semibold text-primary", perf)); info.append(div("text-xs text-gray-500 dark:text-gray-400", s.date)); right.append(info);

        const del = div("opacity-0 group-hover:opacity-100 w-5 h-5 text-white rounded-full bg-gradient-to-r from-red-500/80 to-red-600/80 hover:from-red-500 hover:to-red-600 flex items-center justify-center text-xs cursor-pointer transition-all duration-200", "√ó");
        del.setAttribute("aria-label", "Delete entry"); del.addEventListener("click", () => { workoutHistory.splice(i, 1); saveJSON("abcWorkoutHistory", workoutHistory); updateProgressHistory() });
        right.append(del); row.append(right); return row;
      }
    })();
  </script>
</body>

</html>